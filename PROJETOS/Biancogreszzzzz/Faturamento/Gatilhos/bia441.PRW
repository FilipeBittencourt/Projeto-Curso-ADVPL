#include "rwmake.ch"
#include "topconn.ch"

User Function BIA441()

	/*/
	
	Ŀ
	Funo     BIA441      Autor  MICROSIGA VITORIA      Data  24/07/08 
	Ĵ
	Descrio  Obtem proxima faixa para regra de desconto                   
	Ĵ
	 Uso       Interpretador x Base                                         
	ٱ
	
	
	/*/

	Local i

	Private nFaixa, nPosGrp, cGrupo, nPosPrd, cProduto  

	nPosGrp	 := AScan(aHeader, { |x| Alltrim(x[2]) == 'ACP_GRUPO'})
	cGrupo 	 := aCols[n,nPosgrp]

	nPosPrd	 := AScan(aHeader, { |x| Alltrim(x[2]) == 'ACP_CODPRO'})
	cProduto := aCols[n,nPosPrd]

	nFaixa := 0 

	For i := 1 to n
		IF aCols[i,nPosPrd] == cProduto
			nFaixa := nFaixa + 1
		ENDIF
	Next

	IF nFaixa == 0
		nFaixa := 1
	ENDIF

	DbSelectArea("ACP")    
	DbSetOrder(1)

Return(nFaixa)
